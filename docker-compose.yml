services:
  dev:
    build:
      context: .
      dockerfile: Dockerfile
    # Nom de container dynamique basé sur COMPOSE_PROJECT_NAME
    container_name: ${COMPOSE_PROJECT_NAME:-playlab42}-dev
    # Utiliser l'UID/GID de l'utilisateur host pour les bons droits sur les fichiers
    user: "${LOCAL_UID:-1000}:${LOCAL_GID:-1000}"
    volumes:
      - .:/workspace
      - node_modules:/workspace/node_modules
    working_dir: /workspace
    ports:
      - "${PLAYLAB_PORT:-5242}:5242"      # Application (port externe configurable)
    environment:
      - NODE_ENV=development
      # Home temporaire pour npm/node (évite les erreurs de permissions)
      - HOME=/tmp
      - npm_config_cache=/tmp/.npm
    networks:
      - playlab42-network

networks:
  playlab42-network:
    driver: bridge

volumes:
  node_modules:
