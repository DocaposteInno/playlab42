<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Contexte et specs - D√©veloppement parall√®le avec agents IA</title>
  <link rel="stylesheet" href="../../../../../lib/theme.css">
  <link rel="stylesheet" href="../../../../_shared/slide-base.css">
  <script type="module">
    import { initTheme } from '../../../../../lib/theme.js';
    initTheme();
  </script>
  <style>
    .context-flow {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: var(--space-md);
      flex-wrap: wrap;
      margin: var(--space-xl) 0;
      padding: var(--space-lg);
      background: var(--color-bg-secondary);
      border-radius: var(--radius-lg);
    }
    .flow-item {
      background: var(--color-bg-primary);
      padding: var(--space-md) var(--space-lg);
      border-radius: var(--radius-md);
      text-align: center;
      border: 2px solid var(--color-border);
    }
    .flow-item.highlight {
      border-color: var(--color-accent);
      background: linear-gradient(135deg, var(--color-bg-primary) 0%, var(--color-bg-secondary) 100%);
    }
    .flow-arrow {
      font-size: 1.5rem;
      color: var(--color-accent);
    }
    .structure-diagram {
      background: var(--color-bg-code);
      padding: var(--space-lg);
      border-radius: var(--radius-lg);
      margin: var(--space-lg) 0;
      font-family: 'JetBrains Mono', 'Fira Code', monospace;
      font-size: var(--font-size-sm);
      overflow-x: auto;
    }
    .code-block {
      background: var(--color-bg-code);
      border-radius: var(--radius-md);
      overflow: hidden;
      margin: var(--space-md) 0;
    }
    .code-block-header {
      background: var(--color-bg-secondary);
      padding: var(--space-sm) var(--space-md);
      font-size: var(--font-size-sm);
      color: var(--color-text-muted);
      border-bottom: 1px solid var(--color-border);
    }
    .code-block pre {
      margin: 0;
      padding: var(--space-md);
      overflow-x: auto;
      font-size: var(--font-size-sm);
    }
    .two-columns {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: var(--space-lg);
      margin: var(--space-lg) 0;
    }
    @media (max-width: 768px) {
      .two-columns {
        grid-template-columns: 1fr;
      }
    }
    .column-card {
      background: var(--color-bg-secondary);
      padding: var(--space-lg);
      border-radius: var(--radius-lg);
    }
    .column-card h3 {
      margin-top: 0;
    }
    .tools-section {
      background: var(--color-bg-secondary);
      padding: var(--space-lg);
      border-radius: var(--radius-lg);
      margin: var(--space-xl) 0;
    }
    .tools-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: var(--space-md);
      margin-top: var(--space-md);
    }
    .tool-card {
      background: var(--color-bg-primary);
      padding: var(--space-md);
      border-radius: var(--radius-md);
      border-left: 3px solid var(--color-accent);
    }
    .tool-card h4 {
      margin: 0 0 var(--space-xs);
      color: var(--color-accent);
    }
    .tool-card p {
      margin: 0;
      font-size: var(--font-size-sm);
      color: var(--color-text-muted);
    }
    .comparison-table {
      width: 100%;
      border-collapse: collapse;
      margin: var(--space-lg) 0;
      font-size: var(--font-size-sm);
    }
    .comparison-table th, .comparison-table td {
      padding: var(--space-sm) var(--space-md);
      border: 1px solid var(--color-border);
      text-align: left;
    }
    .comparison-table th {
      background: var(--color-bg-secondary);
    }
    .comparison-table tr:last-child {
      background: rgba(var(--color-accent-rgb), 0.1);
    }
    .callout {
      background: var(--color-bg-secondary);
      border-left: 4px solid var(--color-info);
      padding: var(--space-md) var(--space-lg);
      margin: var(--space-lg) 0;
      border-radius: 0 var(--radius-md) var(--radius-md) 0;
    }
    .comment { color: var(--color-text-muted); }
  </style>
</head>
<body>
  <article class="slide">
    <h1>üìã Donner le contexte aux agents : specs, pas duplication</h1>

    <h2>Le probl√®me du contexte</h2>

    <p>Chaque agent a besoin de savoir :</p>
    <ul>
      <li>Ce qu'il doit faire (la t√¢che)</li>
      <li>Ce qu'il ne doit pas toucher (le scope)</li>
      <li>Les conventions du projet</li>
    </ul>

    <p>
      La tentation serait de dupliquer un fichier de config dans chaque worktree.
      <strong>Mauvaise id√©e</strong> : √ßa diverge, c'est difficile √† maintenir, et √ßa ne scale pas.
    </p>

    <h2>L'approche spec-driven</h2>

    <div class="context-flow">
      <div class="flow-item">
        <strong>CLAUDE.md</strong><br>
        <small>Conventions globales</small>
      </div>
      <span class="flow-arrow">+</span>
      <div class="flow-item">
        <strong>specs/*.md</strong><br>
        <small>Spec par t√¢che</small>
      </div>
      <span class="flow-arrow">‚Üí</span>
      <div class="flow-item highlight">
        <strong>ü§ñ Agent</strong><br>
        <small>Contexte complet</small>
      </div>
      <span class="flow-arrow">‚Üí</span>
      <div class="flow-item">
        <strong>Code</strong><br>
        <small>R√©sultat</small>
      </div>
    </div>

    <div class="structure-diagram">
<pre>project/
‚îú‚îÄ‚îÄ CLAUDE.md              <span class="comment"># Conventions globales (ou AGENTS.md)</span>
‚îú‚îÄ‚îÄ specs/
‚îÇ   ‚îú‚îÄ‚îÄ auth-oauth.md      <span class="comment"># Spec pour agent 1</span>
‚îÇ   ‚îú‚îÄ‚îÄ api-notifications.md   <span class="comment"># Spec pour agent 2</span>
‚îÇ   ‚îî‚îÄ‚îÄ fix-tests.md       <span class="comment"># Spec pour agent 3</span>
‚îú‚îÄ‚îÄ main/                  <span class="comment"># Worktree principal</span>
‚îú‚îÄ‚îÄ agent-1-auth/          <span class="comment"># Worktree agent 1</span>
‚îú‚îÄ‚îÄ agent-2-api/           <span class="comment"># Worktree agent 2</span>
‚îî‚îÄ‚îÄ agent-3-tests/         <span class="comment"># Worktree agent 3</span></pre>
    </div>

    <div class="two-columns">
      <div class="column-card">
        <h3>üìÑ CLAUDE.md global</h3>
        <div class="code-block">
          <div class="code-block-header">CLAUDE.md</div>
          <pre><code><span class="comment"># CLAUDE.md</span>

## Stack
- Node.js 20, TypeScript, Express
- PostgreSQL, Prisma ORM
- Jest pour les tests

## Conventions
- Commits conventionnels (feat:, fix:, etc.)
- Tests obligatoires pour toute nouvelle fonction
- Pas de modifications de schema DB sans validation humaine

## Structure
- src/api/ ‚Äî endpoints REST
- src/services/ ‚Äî logique m√©tier
- src/auth/ ‚Äî authentification
- tests/ ‚Äî tests unitaires et int√©gration</code></pre>
        </div>
      </div>

      <div class="column-card">
        <h3>üìù Spec par t√¢che</h3>
        <div class="code-block">
          <div class="code-block-header">specs/auth-oauth.md</div>
          <pre><code><span class="comment"># Spec: Authentification OAuth Google</span>

## Objectif
Permettre aux utilisateurs de se connecter via leur compte Google.

## Scope
- Fichiers √† cr√©er/modifier : src/auth/oauth.ts, src/auth/google.ts
- Tests : tests/auth/oauth.test.ts

## Hors scope
- Ne PAS modifier les autres providers d'auth
- Ne PAS toucher √† src/api/**

## Crit√®res de succ√®s
- [ ] Endpoint POST /auth/google fonctionnel
- [ ] Token JWT g√©n√©r√© apr√®s auth r√©ussie
- [ ] Tests passent</code></pre>
        </div>
      </div>
    </div>

    <h2>Lancer un agent avec sa spec</h2>

    <div class="code-block">
      <div class="code-block-header">Claude Code</div>
      <pre><code>cd agent-1-auth
claude "Impl√©mente @specs/auth-oauth.md"</code></pre>
    </div>

    <div class="callout">
      Le <code>@</code> permet √† Claude de lire le fichier. Il aura aussi acc√®s au CLAUDE.md global automatiquement.
    </div>

    <div class="code-block">
      <div class="code-block-header">Aider</div>
      <pre><code>cd agent-1-auth
aider --read specs/auth-oauth.md
<span class="comment"># Puis dans Aider : "Impl√©mente cette spec"</span></code></pre>
    </div>

    <div class="tools-section">
      <h3>üõ†Ô∏è Outils de spec-driven development</h3>
      <div class="tools-grid">
        <div class="tool-card">
          <h4>OpenSpec</h4>
          <p>Workflow structur√© : proposal ‚Üí apply ‚Üí archive. Compatible multi-outils.</p>
        </div>
        <div class="tool-card">
          <h4>Spec Kit</h4>
          <p>Par GitHub, orient√© workflow en 4 phases : /specify ‚Üí /plan ‚Üí /tasks ‚Üí implement</p>
        </div>
        <div class="tool-card">
          <h4>AGENTS.md</h4>
          <p>Convention √©mergente pour fichier d'instructions compatible multi-outils.</p>
        </div>
      </div>
    </div>

    <h2>Pourquoi cette approche est meilleure</h2>

    <table class="comparison-table">
      <thead>
        <tr>
          <th>Approche</th>
          <th>Avantages</th>
          <th>Inconv√©nients</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>Config dupliqu√©e par worktree</td>
          <td>Simple au d√©but</td>
          <td>Divergence, maintenance, pas de vue globale</td>
        </tr>
        <tr>
          <td><strong>Spec-driven</strong></td>
          <td>Source unique de v√©rit√©, specs versionn√©es, r√©utilisables</td>
          <td>Demande un peu plus de setup initial</td>
        </tr>
      </tbody>
    </table>

    <p>
      Les specs deviennent une <strong>documentation vivante</strong> du projet.
      Quand une feature est termin√©e, la spec documente ce qui a √©t√© fait et pourquoi.
    </p>
  </article>
</body>
</html>
